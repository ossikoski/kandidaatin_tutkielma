Tässä alaluvussa kartoitetaan mahdollisia ratkaisuja alaluvussa \ref{ch:vanhan_ongelmat} esitetyille ongelmille ja tehdään lyhyt kirjallisuuskatsaus aikaisempiin aiheeseen liittyviin tutkimuksiin, sekä esitellään ideoita ongelman ratkaisemiseksi. Tämän lisäksi valitaan työssä käytetty ratkaisu ja perustellaan sen valinta.

Kuten alaluvussa \ref{ch:vanhan_ongelmat} todettiin, myös Suomen alkoholilaki määrittää alkoholin perusannokset. Lakisääteisyys alkoholin tarjoilussa on saanut aikaan erilaisia ratkaisuja mitata tarjoiltavaa juomaa ihmistenkin tarjoilemana. Jopa englanninkielinen Wikipedia-artikkeli määrittelee alkoholijuomien mittaamistavat omaan luokkiinsa \cite{Wikipedia}. Mitta-astioiden ja tavallisten, kuvassa \ref{fig:kaatonokka} esitettyjen kaatonokkien lisäksi on olemassa juoman virtausta mittaavia kaatonokkia. Kuten johdantoluvussa todettiin, on myös olemassa korkkeja, joissa on pieni tila johon juomaa virtaa tietty määrä, ja sitten korkin venttiilin avaamalla tuon määrän voi laskea tilasta ulos. Tämän jälkeen tila täyttyy uudelleen pullossa olevalla juomalla. Tämä ratkaisu vaatii kuitenkin pullon olevan ylösalaisin jonkinlaisessa telineessä tai esimerkiksi juuri katossa roikkumassa. Tämän lisäksi on olemassa kaatonokkia, jotka sulkeutuvat automaattisesti kun juomaa on virrannut tarpeeksi. Niissä voi esimerkiksi olla sisällä pieni metallinen kuula, joka nosteen ansiosta nousee tietyllä nopeudella ylöspäin ja lopulta tukkii juoman virtauksen \cite{Barproducts}. Tällaisia kaatonokkia on ollut testattavana Pullonkaula ry:llä, mutta niitä ei ole koskaan saatu käytettyä luotettavasti, ja näin niiden käytöstä on luovuttu.

Nesteiden kaatamista astiasta toiseen on tutkittu paljon metallin valannan yhteydessä ja useamman tutkimuksen ovat tehneet Noda et al. \cite{Noda2007,Noda2008,Noda2009}. Metallin valannassa tarvitsee kaataa nestemäisessä olomuodossa olevaa metallia sisältävästä astiasta materiaalia muottiin tarkasti astiaa kallistamalla. Kaadoilta vaaditaan nopeutta ja tarkkuutta sekä virtaavan metallin määrän että muottiin osumisen suhteen. Robotin käyttö on tällaisessa tapauksessa hyödyllistä, koska sula metalli luo vaarallisen työympäristön. Robotille voisi opettaa jokaisen kaatotapauksen erikseen, mutta se on aikaa vievää ja hankalaa, sekä altista muuttujille. Verrattuna juomien tarjoiluun, metalli saattaa esimerkiksi paakkuuntua kaatoastian reunaan, jolloin se vaikuttaa virtaukseen. Sen takia on kehitetty edistyneempiä tapoja hallita kaatoa robotilla. Esimerkiksi Noda ja Terashima kehittivät epälineaarisen mallin kaadolle ja käyttivät sen ohjaamiseen etukompensaatiota \cite{Noda2007}. Myöhemmin he käyttivät laajennettua Kalman-suodatinta kaatoprosessin tilojen, eli nesteen korkeuden kaatoastian suulla ja nesteen massan kohdeastiassa, estimointiin \cite{Noda2009}. Kaatoastian suoristuksen aikana virtaavan nesteen määrää mallinnettiin ja siitä saatiin laskettua tarkempi ajoitus suoristuksen aloittamiselle. Menetelmää testattiin vedellä ja sillä päästiin keskimäärin 1,7 \%:n tarkkuuteen, ja virhe oli kaikissa tapauksissa korkeintaan 3 \%.

Yksi tapa saada juomien kaadosta tarkka on mitata kaadettua määrää jollain tavalla. Tätä määrän mittausta voidaan käyttää ikään kuin takaisinkytkentänä kaadon lopettamiselle tai säätämiselle. Kaadetun määrän mittaamiseen voidaan käyttää visuaalista dataa kameroiden tai 3D-skannerien avulla. Myös voima-antureilla, joko robotin akseleilta tai kohdeastian alta, mitattua dataa voidaan käyttää. Jopa audion \cite{Liang2019}, tai audio- ja voima-anturidatan yhdistelmää \cite{Liang2020} kaadetun määrän arvioimiseen ovat tutkineet Liang et al.

Kameroilta saatavan datan käyttöä juomien kaadossa ovat tutkineet mm. Schenck ja Fox, jotka käyttivät konvoluutioneuroverkkoja arvioimaan nesteen määrää kohdeastiasta saadusta kuvamateriaalista. He käyttivät tätä mittausta yksinkertaisen PID-säätimen takaisinkytkentänä, ja säädin ohjasi robotin rannenivelen eli uloimman akselin kulmaa ja näin pystyi säätämään juoman kaatoa. Tulokset olivat keskimäärin hyviä, mutta ne vaihtelivat melko paljon, jopa sadalla millilitralla. \cite{Schenck2016}

Tässä työssä käytetty Yaskawan HC-10 on monitoimirobotti, mikä tarkoittaa sitä, että sen akseleissa on voima-anturit. Näitä voima-antureita käytetään esimerkiksi törmäysten havaitsemiseksi, jolloin robotti voi törmättyään pysähtyä, tai siihen että operaattori voi käsin työntämällä ohjata robottia. Yaskawan HC-10:n käsiohjaimen käyttöliittymässä on sivu, jolta näkee kaikkiin akseleihin sekä robotin päähän kohdistuvan voiman eri koordinaattisuunnissa reaaliaikaisesti. Nämä voimat on laskettu kaikkien kuuden voima-anturin datan, sekä akselien asennon pohjalta. \cite[s.10-11]{Yaskawa} Aluksi hypoteesina oli, että näiden voima-anturien dataa voisi käyttää robotin tarttujassa olevan massan mittaamiseen. Tämän tiedon massasta voisi integroida osaksi robotin tehtäväohjelmaa, jolloin robotti pystyisi itse saamaan tiedon siitä, paljonko juomaa tarttujassa olevasta pullosta on jo kaadettu. Tällöin esimerkiksi tilanteessa, jossa kaatonokka tukkeutuu, tilanne voitaisiin havaita ja silloin yrittää uutta kaatoa. Tämän ratkaisun esteeksi tuli itse voima-anturien tarkkuus HC-10:ssä. Esimerkiksi pystysuoraan koordinaattisuuntaan vaikuttava voima heittelee jatkuvasti usean Newtonin verran käyttöliittymästä nähtävän datan perusteella. Lisäksi epätarkkuutta lisää se, jos robottikäsi tai pullossa oleva juoma on vähänkään muuttuvassa liikkeessä johonkin suuntaan.

Robotin nivelen voima-anturia kaadon apuna ovat käyttäneet esimerkiksi Rozo et al. Tässä tapauksessa ei kuitenkaan käytetty robotin akselien sisäisiä voima-antureita, vaan yksittäistä ulkoista voima-anturia asetettuna robotin ranneniveleen. Heidän lähestymistapansa hyödynsi robotin opettamista demonstraation avulla. Ensin ihminen ohjaa haptisella etäohjaimella robottia kaatamaan juomia, ja näistä kaadoista kerätään dataa voima-anturilta. Tältä anturilta saadaan myös arvio tarttujassa olevan pullon sisältämästä juomamäärästä. Tätä dataa käytetään parametrisen Markovin piilomallin avulla luomaan yhteys voima-anturien lukemien ja kaadetun juomamäärän välillä. Sen jälkeen tämän avulla robotti jäljentää aikaisempia ihmisen opettamia kaatoja ja pyrkii kaatamaan tietyn määrän juomaa. Tapaa testatessa ei kuitenkaan kaadettu nesteitä, vaan pieniä metallikuulia, joilla simuloitiin nestettä. Tulosten esittelyssä keskityttiin enemmän siihen, että robotti saatiin seuraamaan ihmisen opettamia kaatoja, eikä tarkennettu, olivatko kaadot määriltään tarkkoja vai eivät. \cite{Rozo2013}

Yksi tapa mitata kaadettua massaa on yksinkertaisesti asettaa jonkinlainen painoanturi tai vaaka kohteena olevan mukin alle ja käyttää sen antamaa lukemaa apuna. Tässä työssä on valittu tämä tapa ratkaisuksi kaatomäärän tarkkuuden parantamiseen. Tämän ratkaisun etuna on sen yksinkertaisuus, koska se ei aseta suuria vaatimuksia käytettävälle robotille tai robottisolulle. Vaa'an käyttöön voisi yhdistää kaatokulman säädön, kuten Schenck ja Fox tekivät \cite{Schenck2016}. Samoin pullon suoristuksen aikana virtaavaa nestettä voisi eri tilanteissa mallintaa tarkemmin, kuten Noda et al. tekivät \cite{Noda2008}. Tässä työssä on kuitenkin käytetty yksinkertaisempaa, tapahtumapohjaisuuteen perustuvaa ratkaisua ja suoristuksen aikana virtaavaa nestettä approksimoitiin vakiolla. Massan mittaamista painoanturilla helpottaa myös se, että Drinkkirobotin robottisolussa on jo käytössä vaaka pullonvaihtopisteellä, ja se kommunikoi robotin logiikan kanssa. Tätä vaakaa voidaan käyttää testaamaan tavan toimivuutta ja sitten jälkeenpäin hankkia kaikkien kaatopisteiden alle erilliset vaa'at ja käyttää niitä samalla tekniikalla.
